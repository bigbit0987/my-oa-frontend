# OA项目管理系统 - 前端功能规格说明书

> **版本号**: v2.0
> **最后更新**: 2025-12-25
> **状态**: 正式版

## 1. 📖 引言
本文档详细描述了 OA 项目管理系统前端的界面功能、交互逻辑与业务流程。基于《用户操作使用说明书》与现有技术架构编制，作为开发、测试与验收的依据。

---

## 2. 📱 核心功能域 (Core Modules)

系统前端划分为四大核心功能域：

| 功能域 | 模块代码 | 英文名称 | 核心职责 |
| :--- | :--- | :--- | :--- |
| **门户** | `Dashboard` | Portal | 工作台、消息通知、统一入口 |
| **项目** | `Project` | Project Center | 项目台账、全生命周期档案、项目大屏 |
| **流程** | `Process` | Process Center | 流程发起、任务办理、审批流转 |
| **管理** | `Admin` | System Admin | 组织架构、权限配置、字典管理 |

---

## 3. 🖥️ 详细功能描述

### 3.1 门户工作台 (Portal & Dashboard)
**设计理念**: "Morning Hub" - 用户每天上班的第一个页面，高密度聚合关键信息。
*   **KPI 看板**: 展示 "我的待办"（红灯预警）、"进行中项目" 等核心指标。
*   **Bento Grid 布局**: 采用卡片式布局，包含：
    *   **待办速览**: Top 5 紧急待办任务列表，支持一键跳转办理。
    *   **快捷发起**: 常用流程（如项目登记、请假）的快捷入口图标。
    *   **项目概况**: 参与项目的整体进度条展示。
*   **全局导航**: 顶部显示用户信息、搜索栏与消息通知铃铛。

### 3.2 项目中心 (Project Center)
**核心价值**: 项目数据的全生命周期管理与可视化档案。
1.  **项目台账 (Project Ledger)**
    *   **超级列表**: 基于 ProTable，支持按项目类型 (I-V类)、状态、年份进行多维筛选。
    *   **状态标签**: 清晰展示项目当前所处阶段（如：方案审查中、送审中、已归档）。
2.  **项目详情大屏 (Project Profile)**
    *   **Visual Timeline**: 顶部的可视化进度条，展示项目从“登记”到“归档”的 7 大阶段，高亮当前阶段。
    *   **概况视图**: 项目基础信息（位置、规模、负责人）。
    *   **流程视图**: 该项目产生的所有历史流程记录，支持点击查阅快照。
    *   **附件柜**: 自动聚合各流程节点上传的附件（如方案文本、DWG图纸），支持在线预览。

### 3.3 流程中心 (Process Center)
**核心价值**: 驱动业务流转的引擎。
1.  **流程发起 (Initiation)**
    *   展示所有可发起的业务流程磁贴，支持按分类检索（项目类、行政类）。
2.  **任务办理 (Task Execution)** - **✨ 核心页面**
    *   **三段式布局**:
        *   **左侧 (Form)**: 动态表单区域，根据业务场景展示不同字段。
        *   **右侧 (Timeline)**: 审批流转记录，清晰展示 "谁-在什么时间-做了什么"。
        *   **底部 (ActionBar)**: 吸底操作栏，提供 "同意"、"驳回"、"转办"、"加签"、"暂存" 按钮。
3.  **我的申请**: 查看自己发起流程的状态与审批进度。

### 3.4 系统管理 (Administration)
*   **组织架构**: 用户、部门、角色的增删改查。
*   **表单权限矩阵**: 配置特定角色在特定流程节点对特定字段的可见性 (Read/Write/Hidden)。
*   **数据字典**: 维护项目类型、合同状态等下拉选项数据。

---

## 4. 🔄 核心业务流程 (Business Workflows)

根据实际业务逻辑（参考《用户操作说明书》），系统需支撑以下 7 大核心阶段：

### 4.1 项目登记 (Project Registration)
*   **业务逻辑**: 
    *   生产经营室登记项目信息。
    *   **项目分级**: 自动分为 I、II、III、IV、V 类项目。
    *   **人员指派**: 确定项目主管、项目负责人及项目组成员。
    *   **自动触发**: 登记完成后，Ⅰ-Ⅲ类项目自动触发“产品实现策划”流程。

### 4.2 事前准备 (Pre-preparation)
*   **产品实现策划**: 制定项目计划与质量目标。
*   **现场踏勘**: 填写踏勘记录，支持移动端上传现场照片。
*   **设计输入评审**: 对设计依据和输入资料进行评审确认。

### 4.3 方案审查 (Scheme Review)
涵盖 **所内审查** 与 **院级审查** 两级管控：
*   **所审**: 记录所内会议意见，验证修改结果。
*   **院审申请**: 只有通过所审后，方可由技术办统一排期发起院审会申请。
*   **院审记录**: 记录专家意见，并跟踪落实情况。

### 4.4 成果送审与审定 (Deliverables)
执行严格的质量控制流程：
1.  **校对**: 工程校对 + 规划校对。
2.  **审核**: 所级审核 + 技术办审核。
3.  **审定**: 院领导或授权总工进行最终审定。
*   **交叉审核**: 系统支持跨部门交叉审核逻辑。

### 4.5 归档与评分 (Archiving & Scoring)
*   **归档申请**: 提交电子与纸质文件移交清单。
*   **任务完成认定**:
    *   **自动评分**: 系统根据工期延误情况自动计算工期分。
    *   **质量评分**: 集成技术办记录的质量扣分点，计算质量分。
    *   **综合得分**: 加权计算最终得分，作为绩效依据。

### 4.6 项目变更 (Project Changes)
支持 8 类变更业务的在线审批：
1.  名称变更
2.  编号变更
3.  人员变更
4.  工期变更（需区分实际工期与计划工期）
5.  流程管控级别变更
6.  项目终止/取消
7.  项目恢复
8.  紧急放行（允许跳过部分非关键流程）

### 4.7 其他流程
*   成果交接确认
*   出图通知单
*   公告图流程

---

## 5. 🎨 交互体验规范

1.  **操作反馈**:
    *   成功操作必须有 `Message.success` 提示。
    *   危险操作（如驳回、删除）必须有 `Modal.confirm` 二次确认。
2.  **表单体验**:
    *   只读态使用 "ReadPretty" 模式（纯文本渲染），而非置灰的输入框，提升易读性。
    *   复杂表单支持分步填写 (Step Form) 或 分组折叠 (Collapse)。
3.  **错误处理**:
    *   接口 401 自动跳转登录页。
    *   接口 500 弹出友好错误提示，并支持复制 Request ID 以便排查。

---

## 6. 📋 表单 Schema 索引 (Form Index)

系统共定义 **32 个** Formily JSON Schema，存放于 `doc/forms/` 目录，按业务阶段分类如下：

| 阶段 | 表单文件 | 中文名称 |
| :--- | :--- | :--- |
| **项目登记** | `project_registration.form.json` | 项目信息登记 |
| **事前准备** | `product_realization_plan.form.json` | 产品实现策划 |
|  | `site_survey_record.form.json` | 现场踏勘记录 |
|  | `design_input_review.form.json` | 设计输入评审 |
| **方案审查** | `scheme_institute_review_record.form.json` | 方案所审记录 |
|  | `scheme_hospital_review_application.form.json` | 方案院审申请 |
|  | `scheme_hospital_review_conference_record.form.json` | 方案院审会记录 |
| **送审成果** | `submission_inter_review_record.form.json` | 送审所内审核 |
|  | `submission_tech_assistant_opinion_record.form.json` | 送审技术助理意见 |
|  | `submission_cross_review_record.form.json` | 送审交叉审核 |
|  | `submission_approval_opinion_record.form.json` | 送审审定记录 |
| **正式成果** | `formal_inter_review_record.form.json` | 正式所内审核 |
|  | `formal_tech_assistant_opinion_record.form.json` | 正式技术助理意见 |
|  | `formal_cross_review_record.form.json` | 正式交叉审核 |
|  | `formal_approval_opinion_record.form.json` | 正式审定记录 |
| **归档评分** | `archiving_schedule_plan.form.json` | 归档工期计划 |
|  | `project_archiving.form.json` | 项目归档申请 |
|  | `customer_property_archiving.form.json` | 顾客财产归档 |
|  | `task_completion_confirm.form.json` | 任务完成认定 |
|  | `assignment_check_confirmation.form.json` | 任务书接收确认 |
|  | `archiving_transfer_checklist.form.json` | 归档移交清单 |
|  | `innovation_quality_assessment_application.form.json` | 创新创优申报 |
|  | `data_augmentation_assessment_application.form.json` | 数据增强申报 |
| **项目变更** | `project_change_application.form.json` | 项目变更申请 (含名称/编号/人员/工期等) |
|  | `project_termination_application.form.json` | 项目终止申请 |
|  | `project_resumption_application.form.json` | 项目恢复申请 |
|  | `emergency_release_application.form.json` | 紧急放行申请 |
| **其他** | `achievement_handover_confirmation.form.json` | 成果交接确认 |
|  | `verification_handover_confirmation.form.json` | 核定交接确认 |
|  | `customer_communication_record.form.json` | 顾客沟通记录 |
|  | `announcement_map_flow.form.json` | 公告图流程 |
|  | `plotting_notice.form.json` | 出图通知单 |

---

## 7. 📊 项目分级流程矩阵 (I-V Class Process Matrix)

不同类别项目在各阶段的流程走向规则如下（`√` = 必走, `○` = 可选/可跳过, `×` = 不走）：

| 阶段 | 流程节点 | I类 | II类 | III类 | IV类 | V类 |
| :--- | :--- | :---: | :---: | :---: | :---: | :---: |
| **事前准备** | 产品实现策划 | √ | √ | √ | × | × |
|  | 现场踏勘 | √ | √ | √ | ○ | × |
|  | 设计输入评审 | √ | √ | √ | √ | ○ |
| **方案审查** | 方案所审 | √ | √ | √ | √ | ○ |
|  | 方案院审 | √ | √ | ○ | × | × |
|  | 送审成果院审 (二次院审) | √ | ○ | ○ | × | × |
| **送审成果** | 项目负责人意见 | √ | √ | √ | √ | × |
|  | 校对意见 | √ | √ | √ | √ | √ |
|  | 所级审核意见 | √ | √ | √ | √ | ○ |
|  | 技术助理意见 | √ | √ | √ | √ | × |
|  | 交叉审核意见 | √ | √ | √ | √ | × |
|  | 审定记录 | √ | √ | √ | √ | √ |
| **正式成果** | 项目负责人意见 | √ | √ | √ | ○ | × |
|  | 校对意见 | √ | √ | √ | ○ | × |
|  | 所级审核意见 | √ | √ | √ | ○ | × |
|  | 技术助理意见 | √ | √ | √ | √ | × |
|  | 交叉审核意见 | √ | × | × | × | × |
|  | 审定记录 | √ | √ | √ | √ | √ |
| **归档评分** | 任务完成认定 | √ | √ | √ | × | × |

> [!NOTE]
> *   **I类**: 院A、院B及所A类任务（控规优化类除外）
> *   **II类**: 所A（优化类）任务
> *   **III类**: 有审核人的所B任务
> *   **IV类**: 所B其他任务
> *   **V类**: 无审核人的简易任务

---

## 8. ⚙️ 非功能性需求 (Non-functional Requirements)

### 8.1 安全与审计
*   **电子签名**: 系统支持电子签名功能，审批过程可追溯。
*   **登录日志**: 记录用户登录 IP、时间、设备信息。
*   **操作日志**: 记录关键业务操作（发起、审批、驳回、终止）。

### 8.2 流程管控
*   **代理制度**: 当审批人不在时，可设置代理人处理其待办。
*   **流程撤回**: 发起人可在未办结前撤回流程，重新编辑后再次提交。
*   **流程移交/终止/复活**: 管理员可介入处理异常流程。
*   **唯一性约束**: 同一项目同类型流程仅允许一个处于进行中状态。

### 8.3 数据同步
*   **HR 系统同步**: 人员数据定时与 HR 系统同步（姓名、工号、职务、排序号等）。
*   **项目信息同步**: 项目变更审批通过后，自动更新所有关联流程表单中的快照字段。

### 8.4 附件管理
*   **存储策略**: 附件统一存储，按项目 ID / 流程类型 / 年份组织目录结构。
*   **在线预览**: 支持 PDF、Office、图片的在线预览，减少下载操作。

---

