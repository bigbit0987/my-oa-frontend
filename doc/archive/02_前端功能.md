为支撑上述业务，前端应用划分为以下核心域：

Workbench (工作台): 聚合待办、已办、通知，作为所有流程任务的统一入口。
Process Center (流程中心):
Task Handle UI: 通用任务办理页，通过 Formily Schema 动态渲染上述 40+ 种表单。
Process View: 展示流程全景图、审批时间线。
Project Hub (项目中心):
Ledger: 项目台账列表。
Profile: 项目详情大屏，聚合该项目下产生的所有流程记录、成果文件、资金状态。
Admin (管理配置):
用户/角色管理。
流程表单权限矩阵配置。

## 📂 4. 目录结构规范 (Project Structure)

```text
src/
├── assets/                 # 静态资源
├── components/             # 通用业务组件
│   ├── FormilyRenderer/    # [核心] 动态表单引擎
│   ├── ProcessTimeline/    # 审批时间线
│   ├── WatermarkWrapper/   # 水印容器
│   └── StatusTag/          # 状态标签
├── layouts/                # 布局容器
│   ├── MainLayout/         # 核心布局 (基于 ProLayout)
│   └── AuthLayout/         # 登录页布局
├── pages/                  # 页面视图 (按业务域划分)
│   ├── Dashboard/          # 工作台
│   ├── Process/            # 流程中心 (TaskList, TaskHandle)
│   ├── Project/            # 项目中心 (ProjectList, ProjectDetail)
│   └── Admin/              # 系统管理
├── services/               # API 服务层
│   ├── schema.ts           # Protocol Loader (含 Mock 逻辑)
│   └── request.ts          # Axios 拦截器
├── stores/                 # Zustand 状态仓库
├── utils/                  # 工具函数
└── mocks/                  # 本地仿真数据 (JSON)
```

目录结构规范

基于 `Vite` + `React` 的轻量化重构目录结构：

```text
src/
├── assets/                 # 静态资源 (Images, Global Styles)
├── components/             # 通用组件库
│   ├── FormilyRenderer/    # [已完成] 动态表单渲染核心引擎
│   ├── ProcessTimeline/    # [已完成] 流程进度可视化组件
│   ├── ProcessDiagram/     # [已完成] BPMN 流程图查看器 (SVG/Canvas)
│   ├── BentoCard/          # [已完成] 仪表盘通用卡片容器
│   ├── WatermarkWrapper/   # [已完成] 全局防泄密水印容器
│   └── StatusTag/          # [已完成] 统一状态标签 (审批中/已完成/驳回)
├── layouts/                # 布局容器
│   ├── MainLayout/         # [已完成] 核心布局 (基于 ProLayout)
│   │   ├── index.tsx
│   │   └── _menu.tsx       # 菜单配置
│   └── AuthLayout/         # [已完成] 登录页布局
├── pages/                  # 页面视图 (按功能域划分)
│   ├── Dashboard/          # [工作台] [已完成]
│   │   ├── index.tsx       # 仪表盘主页
│   │   └── components/     # 仪表盘专用小组件 (KPICard, BentoCard...)
│   ├── Login/              # [已完成] 登录页面
│   ├── Process/            # [流程中心]
│   │   ├── TaskList/       # [已完成] 待办任务列表
│   │   ├── HistoryList/    # [已完成] 已办历史
│   │   ├── TaskHandle/     # [已完成] 任务办理详情页 (核心)
│   │   │   ├── index.tsx
│   │   │   └── components/ # 审批栏、意见区
│   │   └── MyRequest/      # [已完成] 我的申请
│   ├── Project/            # [项目中心]
│   │   ├── ProjectList/    # [已完成] 项目台账 (ProTable)
│   │   ├── ProjectDetail/  # [已完成] 项目详情大屏
│   │   │   ├── index.tsx   # 骨架与 Header
│   │   │   └── components/
│   │   │       ├── VisualTimeline.tsx  # [已完成] 项目阶段进度条
│   │   │       ├── ProjectSummary.tsx  # [已完成] 项目摘要卡片
│   │   │       ├── FinanceView.tsx     # [已完成] 成本/合同看板
│   │   │       ├── TeamView.tsx        # [已完成] 团队成员与工时视图
│   │   │       └── FilesView.tsx       # [已完成] 附件柜
│   └── Admin/              # [系统管理]
│       ├── UserManage/     # [已完成] 用户管理
│       └── PermConfig/     # [已完成] 表单权限配置矩阵
├── services/               # API 接口层 (基于 Axios)
│   ├── auth.ts             # [已完成] 认证相关接口
│   ├── task.ts             # [已完成] 任务相关接口
│   ├── project.ts          # [已完成] 项目相关接口
│   ├── request.ts          # [已完成] Axios 封装
│   └── schema.ts           # [已完成] 表单协议加载与解析
├── stores/                 # 全局状态管理 (Zustand)
│   ├── userStore.ts        # [已完成] 用户信息、Token
│   └── configStore.ts      # [已完成] 主题、全局配置
└── utils/                  # [已完成] 工具函数
    └── index.ts            # 日期/金额格式化、防抖节流等
```

### 1. 后端 API 规范

- 统一标准 ：RESTful API，所有接口以 /api/v1 开头
- 认证方式 ：JWT Bearer Token
- 响应格式 ：标准化的 StandardResponse 格式，包含 success、data、error、timestamp
- 开发环境 ：本地运行在 http://localhost:8080

### 🏗️ 2. 核心功能模块

文档将系统划分为四大核心域：

功能域 核心职责 关键 API 工作台 聚合待办、KPI 统计、紧急预警 我的待办任务 流程中心 驱动 40+个业务流程 任务办理、流程发起 项目中心 项目全生命周期管理 项目登记、台账、详情 系统管理 用户/角色/组织架构管理 用户、部门、字典管理

### 📄 3. 页面功能清单

文档详细列出了前端需要实现的核心页面：

门户层 ：

- Login：登录页
- Dashboard：工作台首页（Bento 布局）
  流程层 ：

- ProcessInitiate：流程发起中心
- TaskList：待办任务列表
- TaskHandle：三段式任务办理页（核心页面）
- RequestHistory：已办历史
  项目层 ：

- ProjectLedger：项目台账
- ProjectProfile：项目详情大屏
  管理层 ：

- 用户/部门/角色管理
- 字段权限配置矩阵

流程发起机制 (Process Initiation)

- [ ] **流程发起中心**: 创建 `/process/start` 页面，按分类展示可发起的流程入口。
- [ ] **流程撤回**: 实现发起人撤销（未办结流程）的功能。
- [ ] **草稿箱**: 实现表单内容的暂存/恢复。

核心功能域设计

### 2.1 工作台 (Dashboard) - "Morning Hub"

- **设计理念**: Bento Grid (便当盒) 布局，信息高密度聚合。
- **核心组件**:
  - **KPI 卡片**: 待办数 (醒目红)、进行中项目数。
  - **紧急待办清单**: Top 5 优先级最高的任务，带倒计时。
  - **快捷发起**: 高频流程入口 (4-6 个图标)。
  - **项目概览**: 关注项目的进度条展示。

### 2.2 流程中心 (Process Center) - "The Factory"

- **页面**: `TaskHandle` (任务办理页) 是系统的心脏。
- **布局**: 三段式设计
  - **左侧 (Main)**: Formily 动态表单区域。
  - **右侧 (Sidebar)**: 审批流转记录 (TimeLine) + 流程图预览。
  - **底部 (Footer)**: 吸底操作栏 (同意/驳回/转办)，确保操作永远可见。

### 2.3 项目中心 (Project Center) - "Digital Archive"

- **页面**: `ProjectProfile` (项目详情大屏)
- **交互**:
  - **Sticky Header**: 滚动时项目基础信息吸顶。
  - **Visual Timeline**: 顶部的项目阶段进度条，点击节点可查看历史表单快照 (Read-Only Formily)。
  - **多维视图**: 补充 `Finance` (成本) 和 `Team` (人力) 视图，实现全维度管理。
  - **附件聚合**: 自动汇总各流程节点上传的文件，并在“附件柜”中统一展示。

---

## 🎨 3. UI/UX 规范摘要

### 色彩系统 (基于 Ant Design)

- **Primary**: `#1890ff` (科技蓝) - 用于主按钮、链接、激活状态。
- **Success**: `#52c41a` (草绿) - 用于“通过”、“完成”、“效率提升”。
- **Warning**: `#faad14` (金黄) - 用于“退回”、“修改中”。
- **Error**: `#ff4d4f` (警示红) - 用于“驳回”、“超时”、“紧急待办”。

### 交互细节

- **表单只读态**: 使用 `ReadPretty` 模式，将输入框转换为纯文本，而不是禁用的灰色输入框，提升阅读体验。
- **操作反馈**:
  - 成功 -> `message.success`
  - 失败 -> `message.error`
  - 危险操作 (如删除/驳回) -> `Modal.confirm` 二次确认。

---

## 🌟 5. 企业级特性增强规划 (Phase 2+)

### 5.1 实时性与交互反馈 (Real-time)

- **全局通知中心**: 引入 WebSocket，实现流程状态变更的实时推送。
- **全局命令面板 (Command Palette)**: 类似 `Ctrl+K` 调出的搜索框，支持快速跳转项目、查找文件。

### 5.2 数据可视化 (Data BI)

- **场景**: 在工作台引入 ECharts/AntV。
- **图表**: 项目漏斗图、人员负荷雷达图。

### 5.3 🛡️ 企业级安全 (Security) - 优先落实

- **动态水印 (Watermark)**:
  - **方案**: 使用 Ant Design 5 原生 `<Watermark>` 组件包裹 `MainLayout` 内容区。
  - **内容**: 显示 "当前用户姓名 + 手机后 4 位"。
  - **价值**: 极低成本实现防拍照泄密。

### 5.4 移动端适配 (Mobile)

- **策略**: PC 端优先。
- **响应式表单规范**: 预留“表单响应式策略”。在 Schema 设计层，所有 `FormGrid` 布局必须定义 `maxColumns` 和 `minColumns`。
  - PC 端: 2-3 列布局。
  - Mobile 端: 强制 1 列 (Stack Layout)，输入框与 Label 垂直排列。

### 5.5 文档与协作 (Collaboration)

- **在线预览**: 在附件柜中集成 PDF/Office 在线预览，减少下载操作。
- **意见模板**: 审批时提供“常用语”快捷选择。

阶段实施明细

### 🟢 Phase 1: 基础设施与安全底座 (Week 1-2)

**目标**: 建立纯净、规范、安全的项目基座，为多人协作打好基础。

| 任务 ID | 任务名称           | 详细说明                                                                                                                                 | 验收标准                                                      | 状态 |
| :-----: | ------------------ | ---------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------- | :--: |
|   1.1   | **初始化项目环境** | - 使用 `npm create vite` 初始化项目<br>- 安装 `React 18` 全家桶 (降级处理)<br>- 配置 `vite.config.ts` 别名 (@/)                          | - `package.json` 依赖版本正确<br>- `npm run dev` 启动 < 500ms |  ✅  |
|   1.2   | **样式系统搭建**   | - 集成 `Tailwind CSS v4` (PostCSS)<br>- 建立 `src/index.css`<br>- **[关键]** 实现 AntD Token -> Tailwind 变量桥接 (如 `--color-primary`) | - HTML 中写 `text-primary` 能正确显示科技蓝                   |  ✅  |
|   1.3   | **安全水印容器**   | - 开发 `WatermarkWrapper` 组件<br>- 集成 AntD 5 原生 Watermark<br>- 动态注入"姓名+手机尾号"                                              | - 页面全屏覆盖水印<br>- 水印不遮挡点击事件                    |  ✅  |
|   1.4   | **主布局开发**     | - 开发 `MainLayout` (基于 ProLayout)<br>- 配置左侧侧边栏与顶部导航<br>- 建立 `src/routes.tsx` 路由表                                     | - 响应式布局正常<br>- 菜单点击跳转正确                        |  ✅  |
|   1.5   | **状态管理基座**   | - 初始化 `Zustand` Store<br>- `useUserStore`: 存储 Token/UserInfo<br>- `useConfigStore`: 存储 Theme/Locale                               | - Redux DevTools 可观测到状态变化                             |  ✅  |

> 📅 **Phase 1 完成日期**: 2024-12-24

### 🔵 Phase 2: 工作台与数据仿真 (Week 3-4)

**目标**: 打造高颜值的 "Morning Hub" (每日第一站)，并打通前后端并行开发流程。

| 任务 ID | 任务名称             | 详细说明                                                                                                              | 验收标准                                       | 状态 |
| :-----: | -------------------- | --------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------- | :--: |
|   2.1   | **Schema Mock 机制** | - 建立 `src/services/schema.ts`<br>- 实现"本地/远程"双模式加载策略<br>- 编写 Mock JSON 文件                           | - 断网环境下依然能加载测试表单                 |  ✅  |
|   2.2   | **Bento Grid 布局**  | - 封装 `BentoCard` 组件<br>- 实现 Grid 响应式布局 (1x1, 2x1, 2x2)                                                     | - 拖拽窗口时卡片自动重排                       |  ✅  |
|   2.3   | **核心 Widget 开发** | - `KPICard`: 待办数/项目数 (带微动画)<br>- `UrgentList`: Top 5 紧急待办 (红灯预警)<br>- `QuickAccess`: 高频入口图标组 | - 卡片加载带 Skeleton 骨架屏                   |  ✅  |
|   2.4   | **数据接口联调**     | - 封装 Axios 拦截器 (Auth/Error Handling)<br>- 对接真实 Dashboard API                                                 | - 401 自动跳转登录<br>- 500 弹出 ErrorBoundary |  ✅  |

> 📅 **Phase 2 完成日期**: 2024-12-24

### 🟠 Phase 3: 流程中心 (Week 5-7)

**目标**: 攻克系统心脏——复杂的动态表单与审批流转。

| 任务 ID | 任务名称         | 详细说明                                                                                                      | 验收标准                                          | 状态 |
| :-----: | ---------------- | ------------------------------------------------------------------------------------------------------------- | ------------------------------------------------- | :--: |
|   3.1   | **表单渲染引擎** | - 封装 `FormilyRenderer` 组件<br>- 注册 AntD 组件库映射<br>- 实现 `x-pattern: readPretty` 只读模式            | - 后端修改 JSON 字段，前端无需发版即生效          |  ✅  |
|   3.2   | **三段式办理页** | - 开发 `TaskHandle` 页面骨架<br>- 左: 表单 (80%) / 右: Timeline (20%)<br>- 底: Sticky Action Bar (吸底操作栏) | - 滚动时操作栏始终可见                            |  ✅  |
|   3.3   | **流程组件库**   | - `ProcessTimeline`: 审批记录可视化<br>- `ProcessDiagram`: BPMN 流程图预览                                    | - 能够清晰展示"谁在什么时间做了什么"              |  ✅  |
|   3.4   | **审批交互逻辑** | - 实现同意/驳回/转办/加签<br>- 集成"常用审批意见"模板                                                         | - 操作成功有 Message 反馈<br>- 危险操作有二次确认 |  ✅  |

> 📅 **Phase 3 完成日期**: 2024-12-24

### 🟣 Phase 4: 项目中心与可视化 (Week 8-10)

**目标**: 实现全维度的项目档案管理与数据大屏。

| 任务 ID | 任务名称         | 详细说明                                                                                                 | 验收标准                      | 状态 |
| :-----: | ---------------- | -------------------------------------------------------------------------------------------------------- | ----------------------------- | :--: |
|   4.1   | **项目台账**     | - 基于 `ProTable` 实现超级列表<br>- 支持高级筛选、列显隐、导出                                           | - 1000 条数据渲染无卡顿       |  ✅  |
|   4.2   | **项目详情大屏** | - 开发 `ProjectProfile` 容器<br>- 实现 Sticky Header (项目摘要吸顶)<br>- 顶部 Visual Timeline 阶段进度条 | - 切换 Tab 时无明显闪烁       |  ✅  |
|   4.3   | **多维业务视图** | - `Finance`: 资金/合同看板<br>- `Team`: 人力负荷视图<br>- `Files`: 附件聚合柜 (按阶段自动归档)           | - 附件支持在线预览 (Phase 4+) |  ✅  |

> 📅 **Phase 4 完成日期**: 2024-12-24

## ✅ 准备工作清单 (Immediate Actions)

- [x] 修剪 `package.json`，锁定 React 18 版本
- [x] 初始化 Git 仓库与 `.gitignore`
- [x] 配置 VSCode `settings.json` (Tailwind IntelliSense)

---

## 📈 开发进度记录

### 2024-12-24 开发日志

**Phase 1 & 2 主要成果：**

| 模块           | 已创建文件                                          | 功能描述                            |
| -------------- | --------------------------------------------------- | ----------------------------------- |
| **Services**   | `schema.ts`, `request.ts`                           | Schema 双模式加载、Axios 拦截器封装 |
| **Stores**     | `userStore.ts`, `configStore.ts`                    | 用户状态、应用配置全局状态管理      |
| **Layouts**    | `MainLayout/index.tsx`, `_menu.tsx`                 | ProLayout 主布局、菜单配置          |
| **Components** | `WatermarkWrapper/`                                 | 安全水印容器                        |
| **Dashboard**  | `index.tsx`, `Dashboard.css`                        | 工作台主页面                        |
| **Widgets**    | `BentoCard`, `KPICard`, `UrgentList`, `QuickAccess` | Bento Grid 卡片组件库               |
| **Mocks**      | `dashboard.json`                                    | 工作台 Mock 数据                    |

**Phase 3 主要成果：**

| 模块                | 已创建文件                       | 功能描述                                |
| ------------------- | -------------------------------- | --------------------------------------- |
| **FormilyRenderer** | `components/FormilyRenderer.tsx` | 表单渲染引擎，支持 JSON Schema 动态渲染 |
| **ProcessTimeline** | `components/ProcessTimeline.tsx` | 审批记录时间线组件                      |
| **ProcessDiagram**  | `components/ProcessDiagram.tsx`  | BPMN 流程图简化预览                     |
| **ApprovalActions** | `components/ApprovalActions.tsx` | 审批操作组件(同意/驳回/转办/加签)       |
| **TaskHandle**      | `TaskHandle/index.tsx`           | 三段式任务办理页面                      |
| **TaskList**        | `TaskList/index.tsx`             | 待办任务列表页面                        |
| **Mocks**           | `taskHandle.json`                | 任务办理 Mock 数据                      |

**Phase 4 主要成果：**

| 模块               | 已创建文件                                     | 功能描述                                |
| ------------------ | ---------------------------------------------- | --------------------------------------- |
| **Services**       | `project.ts`                                   | 项目服务 API 封装，支持 Mock/远程双模式 |
| **ProjectList**    | `ProjectList/index.tsx`, `ProjectList.css`     | 基于 ProTable 的项目台账，含统计卡片    |
| **ProjectDetail**  | `ProjectDetail/index.tsx`, `ProjectDetail.css` | 项目详情大屏容器，多 Tab 视图切换       |
| **VisualTimeline** | `components/VisualTimeline.tsx`, `.css`        | 项目阶段可视化进度条（动画效果）        |
| **ProjectSummary** | `components/ProjectSummary.tsx`, `.css`        | 项目摘要卡片（支持吸顶模式）            |
| **FinanceView**    | `components/FinanceView.tsx`, `.css`           | 资金/合同看板视图                       |
| **TeamView**       | `components/TeamView.tsx`, `.css`              | 人力负荷视图（团队成员工作量）          |
| **FilesView**      | `components/FilesView.tsx`, `.css`             | 附件聚合柜（按阶段自动归档）            |
| **Mocks**          | `projects.json`                                | 项目数据 Mock                           |

**🎉 Phase 1-4 已全部完成！**

# OA 项目管理系统 - 前端页面功能清单

## 1. 门户与基础

| 页面名称   | 路由路径      | 核心功能                                       | 后端关联                       |
| :--------- | :------------ | :--------------------------------------------- | :----------------------------- |
| **登录页** | `/auth/login` | 用户名密码登录、Token 存储、跳转拦截           | `POST /api/v1/auth/login`      |
| **工作台** | `/dashboard`  | 待办统计、项目概览、高频流程入口（Bento 布局） | `GET /api/v1/tasks/statistics` |

## 2. 流程中心 (The Factory)

| 页面名称     | 路由路径                | 核心功能                                                                         | 后端关联                                            |
| :----------- | :---------------------- | :------------------------------------------------------------------------------- | :-------------------------------------------------- |
| **流程发起** | `/process/initiate`     | 展示 30+个可发起流程的磁贴，搜索流程                                             | `GET /api/v1/workflows/definitions`                 |
| **我的待办** | `/process/todo`         | 待办任务列表，支持快速处理跳转                                                   | `GET /api/v1/tasks` (assignee=me)                   |
| **任务办理** | `/process/task/:taskId` | **核心页面**：Formily 表单渲染、审批时间线、附件上传、操作按钮（同意/驳回/草稿） | `GET /api/v1/tasks/{taskId}/form`, `POST /complete` |
| **我的申请** | `/process/my-request`   | 我发起的流程列表，支持查看状态                                                   | `GET /api/v1/workflows/history`                     |
| **已办历史** | `/process/history`      | 我已经处理过的任务记录，只读查看                                                 | `GET /api/v1/tasks/history`                         |

## 3. 项目中心 (Digital Archive)

| 页面名称       | 路由路径                | 核心功能                                                                          | 后端关联                                                 |
| :------------- | :---------------------- | :-------------------------------------------------------------------------------- | :------------------------------------------------------- |
| **项目台账**   | `/project/list`         | 全局项目大列表，多条件筛选、状态看板                                              | `GET /api/v1/projects`                                   |
| **项目详情**   | `/project/:id`          | 项目全景大屏：吸顶 Header、可视化进度 Timeline、Tab 化数据（概况/附件/财务/团队） | `GET /api/v1/projects/{id}`, `GET /api/taskbook/preview` |
| **任务书生成** | `/project/:id/taskbook` | 预览任务书、检查缺失项、生成 PDF 下载                                             | `GET /api/taskbook/download`                             |

## 4. 系统管理 (Control Panel)

| 页面名称      | 路由路径              | 核心功能                                            | 后端关联                               |
| :------------ | :-------------------- | :-------------------------------------------------- | :------------------------------------- |
| **用户/部门** | `/admin/organization` | 组织架构树预览、人员入职/调动、角色分配             | `/api/v1/users`, `/api/v1/departments` |
| **权限配置**  | `/admin/permissions`  | 菜单权限、按钮权限、数据权限配置矩阵                | `/api/v1/permissions`                  |
| **表单权限**  | `/admin/form-perm`    | **关键**：配置 Formily 表单在各节点的 读/写/隐 权限 | `/api/v1/form-permissions/admin`       |
| **数据字典**  | `/admin/dicts`        | 维护下拉框常量、校验器正则表达式                    | `/api/v1/dictionaries`                 |

---

_注：所有页面均受 `WatermarkWrapper` 水印保护，样式遵循 AntD 5 + Tailwind CSS v4 规范。_

🏗️ OA 项目管理系统 - 前端功能设计方案
📋 一、现状分析
1.1 后端 API 能力总览
根据 Swagger API 文档，后端已提供以下功能模块的完整接口：

模块 API 路径前缀 核心能力
认证管理 /api/v1/auth 登录、登出、刷新 Token、密码修改、获取当前用户
用户管理 /api/v1/users 用户 CRUD、角色分配、密码重置、状态管理
部门管理 /api/v1/departments 部门 CRUD、部门树
权限管理 /api/v1/permissions 权限 CRUD、权限树、用户权限检查
角色管理 /api/v1/roles 角色 CRUD、动态角色
项目管理 /api/v1/projects 项目登记、查询、详情、提交流程
工作流管理 /api/v1/workflows 启动流程、暂停/激活/终止、流程图、历史
任务管理 /api/v1/tasks 待办任务、任务办理、回退、转办、加签、草稿
表单管理 /api/v1/forms 表单 Schema、动态数据源、项目详情
表单权限 /api/v1/form-permissions 节点权限、权限模板、运行时 Schema
字典管理 /api/v1/dictionaries 数据字典、校验器
数据继承 /api/data-inheritance 流程间数据继承
任务书 /api/taskbook 任务书预览、下载 PDF、归档清单
1.2 前端现有实现
功能模块 页面 实现状态 备注
登录认证 /auth/login ✅ 已有 AuthLayout + Login 组件
工作台 /dashboard ✅ 骨架 Bento Grid 布局框架已搭建
待办任务 /process/todo ✅ 骨架 TaskList 组件
任务办理 /process/task/:taskId ✅ 骨架 TaskHandle + FormilyRenderer
已办历史 /process/history ✅ 骨架 HistoryList 组件
我的申请 /process/my-request ✅ 骨架 MyRequest 组件
项目列表 /project/list ✅ 骨架 ProjectList 组件
项目详情 /project/:projectId ✅ 骨架 ProjectDetail 组件
用户管理 /admin/users ✅ 骨架 UserManage 组件
权限配置 /admin/permissions ✅ 骨架 PermConfig 组件
1.3 表单 Schema 覆盖情况
已定义 32 个 完整的 Formily JSON Schema：

类别 表单数量 具体流程
项目登记与策划 4 项目登记、产品实现策划、现场踏勘、设计输入评审
方案审查 3 方案所审、方案院审申请、方案院审会议记录
送审成果 4 所内审核、技术助理意见、交叉审核、审定记录
正式成果 4 所内审核、技术助理意见、交叉审核、审定记录
归档评分 7 归档计划、归档申请、顾客财产归档、任务完成认定等
项目变更 5 名称/人员/工期变更、终止、恢复运行
其他流程 5 成果交接、核定交接、顾客沟通、公告图、出图通知
📐 二、功能差距分析与建议
2.1 功能域对照表
功能域 后端能力 前端现状 差距评估
认证与安全 ✅ 完整 ⚠️ 基础 需完善 Token 刷新机制、动态水印
工作台 ✅ 完整 ⚠️ 骨架 需对接真实 API、添加统计数据
流程中心 ✅ 完整 ⚠️ 骨架 需打通表单 Schema 加载和权限控制
项目中心 ✅ 完整 ⚠️ 骨架 需实现任务书生成、附件管理
系统管理 ✅ 完整 ⚠️ 仅 UI 需对接用户/部门/权限/角色 API
流程发起 ✅ 完整 ❌ 缺失 需新建流程发起页面
2.2 核心差距详解
🔴 P0 级（必须立即解决）
流程发起页面缺失
后端 POST /api/v1/workflows/start 已支持
前端缺少 ProcessInitiate 页面，用于展示所有可发起流程入口
Schema-权限适配器缺失
API GET /api/v1/form-permissions/runtime/tasks/{taskId}/schema 已提供动态 Schema
FormilyRenderer 需对接此 API 获取带权限的 Schema
API 集成层缺失
src/services/ 目录需要建立完整的 API 调用封装
需实现 authService, taskService, projectService 等
🟡 P1 级（核心体验完善）
工作台数据源对接
API GET /api/v1/tasks/statistics 可获取任务统计
Dashboard 组件需对接真实数据
任务高级操作
后端已支持：转办、加签、驳回发起人、暂存草稿
前端 ApprovalActions 需补充这些操作按钮
项目详情大屏
API GET /api/taskbook/preview/{projectId} 返回完整任务书数据
ProjectDetail 需对接并展示成果清单、评分信息
🟢 P2 级（企业级增强）
通知中心（后端暂无 WebSocket）
命令面板（快捷搜索）
报表与 BI
🗺️ 三、完整页面架构设计
3.1 页面树状结构
📁 前端页面结构
├── 🔐 认证层 (Auth)
│ └── /auth/login - 登录页
│
├── 🏠 门户层 (Portal)
│ └── /dashboard - 工作台（Bento Grid 首页）
│
├── 🔄 流程层 (Process)
│ ├── /process/initiate - ✨ 新增：流程发起中心
│ ├── /process/todo - 待办任务列表
│ ├── /process/task/:taskId - 任务办理页（三段式）
│ ├── /process/history - 已办历史
│ └── /process/my-request - 我的申请
│
├── 📁 项目层 (Project)
│ ├── /project/list - 项目台账
│ ├── /project/:projectId - 项目详情大屏
│ └── /project/:projectId/taskbook - ✨ 新增：任务书预览
│
└── ⚙️ 管理层 (Admin)
├── /admin/users - 用户管理
├── /admin/departments - ✨ 新增：部门管理
├── /admin/roles - ✨ 新增：角色管理
├── /admin/permissions - 权限管理
├── /admin/dictionaries - ✨ 新增：字典管理
└── /admin/form-permissions - ✨ 新增：表单权限配置
3.2 页面详细设计
3.2.1 流程发起中心 (ProcessInitiate) ✨ 新增
功能：展示所有可发起流程的卡片列表，点击后跳转到对应表单填写页

对接 API：

GET /api/v1/workflows/definitions - 获取流程定义列表
UI 设计：

流程分类（项目登记、送审成果、项目变更等）
卡片式布局，每个流程包含图标、名称、描述
快捷发起入口（仪表板首页也可复用）
3.2.2 任务办理页 (TaskHandle) - 增强
现有：三段式布局（左表单、右时间轴、底操作栏）

需增强：

功能 对接 API 说明
动态 Schema 加载 GET /api/v1/form-permissions/runtime/tasks/{taskId}/schema 获取带权限控制的表单 Schema
任务完成 POST /api/v1/tasks/{taskId}/complete 提交表单并流转
回退上一节点 POST /api/v1/tasks/{taskId}/rollback-previous
回退发起人 POST /api/v1/tasks/{taskId}/rollback-initiator
转办 POST /api/v1/tasks/{taskId}/transfer
加签 POST /api/v1/tasks/{taskId}/add-sign
草稿保存 POST /api/v1/tasks/{taskId}/draft
草稿读取 GET /api/v1/tasks/{taskId}/draft
撤回流程 POST /api/v1/workflows/{processInstanceId}/withdraw
3.2.3 项目详情大屏 (ProjectDetail/Profile) - 增强
对接 API：

GET /api/v1/projects/{id} - 项目基本信息
GET /api/taskbook/preview/{projectId} - 任务书完整数据
GET /api/taskbook/status/{projectId} - 生成状态检查
Tab 页设计：

Tab 数据源 功能
概况 ProjectInfo 项目基础信息卡片
流程历史 processTimeline 可视化流程时间线，点击查看历史表单快照
成果清单 deliverables 送审/正式/中间成果列表
评分信息 scoring 方案分、送审分、正式分、工期分、综合分
附件柜 files 按阶段聚合的文件列表
任务书 taskbook 在线预览+PDF 下载
3.2.4 系统管理模块 - 新增页面
页面 路径 对接 API 功能
部门管理 /admin/departments /api/v1/departments 部门树 CRUD
角色管理 /admin/roles /api/v1/roles 角色权限配置
字典管理 /admin/dictionaries /api/v1/dictionaries 下拉框、单选框常量维护
表单权限配置 /admin/form-permissions /api/v1/form-permissions/admin 节点-字段权限矩阵
🛠️ 四、技术实施优先级建议
4.1 实施阶段规划
┌─────────────────────────────────────────────────────────────────┐
│ Phase A：API 集成层建设 (1 周) │
│ ┌──────────────────────────────────────────────────────────┐ │
│ │ • 建立 src/services/ 目录结构 │ │
│ │ • 封装 axios 实例 + Token 拦截器 │ │
│ │ • 实现核心 Service: auth, task, project, form │ │
│ └──────────────────────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────────────┤
│ Phase B：核心流程打通 (2 周) │
│ ┌──────────────────────────────────────────────────────────┐ │
│ │ • FormilyRenderer 对接权限 Schema API │ │
│ │ • TaskHandle 增强 (完整审批操作) │ │
│ │ • 新增 ProcessInitiate 流程发起页 │ │
│ │ • 实现端到端流程：项目登记 → 提交 → 办理 → 完成 │ │
│ └──────────────────────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────────────┤
│ Phase C：数据可视化 (1 周) │
│ ┌──────────────────────────────────────────────────────────┐ │
│ │ • Dashboard 对接真实统计 API │ │
│ │ • ProjectDetail 对接任务书数据 │ │
│ │ • ProjectList 对接分页查询 │ │
│ └──────────────────────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────────────┤
│ Phase D：系统管理完善 (1 周) │
│ ┌──────────────────────────────────────────────────────────┐ │
│ │ • 用户/部门/角色 CRUD 对接 │ │
│ │ • 字典管理页面 │ │
│ │ • 表单权限配置矩阵 │ │
│ └──────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────┘
4.2 决策点：设计功能 vs 与后端打通
根据您的问题「现在是该设计功能，还是与后端打通」，我的建议是：

🎯 建议：先打通后端，再完善功能

理由：

您的后端 API 已经非常完整，32 个表单 Schema 也已定义
前端骨架已搭建完成，差的是"血肉"（数据流）
尽早打通 login → dashboard → task → form → submit 的链路，可以验证架构的可行性
后续功能完善都是在这条"主干"上添枝加叶
第一步行动：

1. 创建 src/services/api.ts (axios 封装+Token 拦截器)
2. 创建 src/services/authService.ts (登录/登出)
3. 修改 Login 页面，对接真实登录 API
4. 修改 Dashboard，从 /api/v1/tasks/statistics 获取真实数据
5. 修改 TaskList，从 /api/v1/tasks 获取待办列表
   📝 五、文档更新建议
   5.1 需要创建/更新的文档
   文档 位置 内容
   前端 API 对接手册 doc/前端 API 对接手册.md 各 Service 的接口定义、请求/响应格式
   页面功能清单 doc/页面功能清单.md 完整的页面列表、路由、功能点
   开发进度追踪 doc/TODO-开发进度.md Phase A/B/C/D 的任务清单和状态
   📌 六、结论与下一步
