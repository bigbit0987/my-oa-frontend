<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL"
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
             xmlns:xsd="http://www.w3.org/2001/XMLSchema"
             xmlns:flowable="http://flowable.org/bpmn"
             xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI"
             xmlns:omgdc="http://www.omg.org/spec/DD/20100524/DC"
             xmlns:omgdi="http://www.omg.org/spec/DD/20100524/DI"
             typeLanguage="http://www.w3.org/2001/XMLSchema"
             expressionLanguage="http://www.w3.org/1999/XPath"
             targetNamespace="http://www.company.com/workflow"
             exporter="Flowable Open Source Modeler"
             exporterVersion="6.8.0">

    <process id="submission_tech_assistant_opinion_record_process" name="送审成果技术助理意见记录流程" isExecutable="true">

        <startEvent id="startEvent" flowable:initiator="initiator" flowable:formKey="submission_tech_assistant_opinion_record" flowable:formFieldValidation="true"/>
        <userTask id="task_submit" name="填写送审信息" flowable:assignee="${initiator}" flowable:formKey="submission_tech_assistant_opinion_record" flowable:formFieldValidation="true">
            <extensionElements>
                <modeler:initiator-can-complete xmlns:modeler="http://flowable.org/modeler">
                    <![CDATA[ false ]]>
                </modeler:initiator-can-complete>
            </extensionElements>
        </userTask>

        <exclusiveGateway id="gateway_is_v_process" name="是否V类流程?"/>

        <userTask id="task_internal_judge" name="所内自主判断" flowable:assignee="${projectManager}"
                  flowable:formKey="submission_tech_assistant_opinion_record" flowable:formFieldValidation="true">
            <extensionElements>
                <modeler:initiator-can-complete xmlns:modeler="http://flowable.org/modeler">
                    <![CDATA[ false ]]>
                </modeler:initiator-can-complete>
            </extensionElements>
        </userTask>
        <exclusiveGateway id="gateway_is_skipped" name="是否跳过技术审核?"/>

        <userTask id="task_select_reviewer" name="项目负责人选择审核人" flowable:assignee="${projectManager}"
                  flowable:formKey="submission_tech_assistant_opinion_record" flowable:formFieldValidation="true">
            <extensionElements>
                <modeler:initiator-can-complete xmlns:modeler="http://flowable.org/modeler">
                    <![CDATA[ false ]]>
                </modeler:initiator-can-complete>
            </extensionElements>
        </userTask>

        <userTask id="task_review_opinion" name="审核人填写意见" flowable:assignee="${techOfficeReviewer}"
                  flowable:formKey="submission_tech_assistant_opinion_record" flowable:formFieldValidation="true">
            <extensionElements>
                <modeler:initiator-can-complete xmlns:modeler="http://flowable.org/modeler">
                    <![CDATA[ false ]]>
                </modeler:initiator-can-complete>
            </extensionElements>
        </userTask>

        <userTask id="task_select_modifier" name="项目负责人选择修改人" flowable:assignee="${projectManager}"
                  flowable:formKey="submission_tech_assistant_opinion_record" flowable:formFieldValidation="true">
            <extensionElements>
                <modeler:initiator-can-complete xmlns:modeler="http://flowable.org/modeler">
                    <![CDATA[ false ]]>
                </modeler:initiator-can-complete>
            </extensionElements>
        </userTask>

        <userTask id="task_modify_record" name="修改并填写记录" flowable:assignee="${modifier}"
                  flowable:formKey="submission_tech_assistant_opinion_record" flowable:formFieldValidation="true">
            <extensionElements>
                <modeler:initiator-can-complete xmlns:modeler="http://flowable.org/modeler">
                    <![CDATA[ false ]]>
                </modeler:initiator-can-complete>
            </extensionElements>
        </userTask>

        <userTask id="task_validate_modification" name="审核人验证修改" flowable:assignee="${techOfficeReviewer}"
                  flowable:formKey="submission_tech_assistant_opinion_record" flowable:formFieldValidation="true">
            <extensionElements>
                <modeler:initiator-can-complete xmlns:modeler="http://flowable.org/modeler">
                    <![CDATA[ false ]]>
                </modeler:initiator-can-complete>
            </extensionElements>
        </userTask>

        <exclusiveGateway id="gateway_validation_result" name="验证是否通过?"/>

        <endEvent id="endEvent_completed" name="流程完成"/>

        <sequenceFlow id="sequenceFlow-fa7eda4d-85ad-4633-b90a-c8e293b49b73" sourceRef="startEvent"
                      targetRef="task_submit"/>
        <sequenceFlow id="sequenceFlow-06f27e05-5cb5-4cac-bc7e-144e50fc4a31" sourceRef="task_submit"
                      targetRef="gateway_is_v_process"/>

        <sequenceFlow id="sequenceFlow-eeb1d2df-4bd3-43b7-b386-a14efc9369e8" name="是V类"
                      sourceRef="gateway_is_v_process" targetRef="task_internal_judge">
            <conditionExpression xsi:type="tFormalExpression">
                <![CDATA[ ${processControlLevel == 'V'} ]]>
            </conditionExpression>
        </sequenceFlow>
        <sequenceFlow id="sequenceFlow-ce91565e-35fa-4bf7-9361-3cfbaf9fe6df" name="非V类"
                      sourceRef="gateway_is_v_process" targetRef="task_select_reviewer">
            <conditionExpression xsi:type="tFormalExpression">
                <![CDATA[ ${processControlLevel != 'V'} ]]>
            </conditionExpression>
        </sequenceFlow>

        <sequenceFlow id="sequenceFlow-93ecc5c9-4e60-4077-9ddd-d9f341c52e2b" sourceRef="task_internal_judge"
                      targetRef="gateway_is_skipped"/>
        <sequenceFlow id="sequenceFlow-33163e23-3b3d-436b-bb26-e3049b48c721" name="跳过" sourceRef="gateway_is_skipped"
                      targetRef="endEvent_completed">
            <conditionExpression xsi:type="tFormalExpression">
                <![CDATA[ ${isSkipped == 'yes'} ]]>
            </conditionExpression>
        </sequenceFlow>
        <sequenceFlow id="sequenceFlow-ccb26438-df06-4ecb-ba16-66738f42435b" name="不跳过"
                      sourceRef="gateway_is_skipped" targetRef="task_select_reviewer">
            <conditionExpression xsi:type="tFormalExpression">
                <![CDATA[ ${isSkipped == 'no' || isSkipped == null} ]]>
            </conditionExpression>
        </sequenceFlow>

        <sequenceFlow id="sequenceFlow-98e8f10a-da79-4ddd-8e1a-54e46ed26d3d" sourceRef="task_select_reviewer"
                      targetRef="task_review_opinion"/>
        <sequenceFlow id="sequenceFlow-28a4933d-521e-4cc9-8d33-dbb26ee86684" sourceRef="task_review_opinion"
                      targetRef="task_select_modifier"/>
        <sequenceFlow id="sequenceFlow-341c6414-dd83-4d3c-a291-e31ec1616fe1" sourceRef="task_select_modifier"
                      targetRef="task_modify_record"/>
        <sequenceFlow id="sequenceFlow-a938f8e3-f266-4006-9f77-114815fecdfd" sourceRef="task_modify_record"
                      targetRef="task_validate_modification"/>
        <sequenceFlow id="sequenceFlow-23016e96-80d0-4a6f-8ac7-9b9776c2f7e2" sourceRef="task_validate_modification"
                      targetRef="gateway_validation_result"/>

        <sequenceFlow id="sequenceFlow-8817e519-85d3-44fb-87fb-815eeaf15a31" name="验证通过"
                      sourceRef="gateway_validation_result" targetRef="endEvent_completed">
            <conditionExpression xsi:type="tFormalExpression">
                <![CDATA[ ${validationResult == 'passed'} ]]>
            </conditionExpression>
        </sequenceFlow>
        <sequenceFlow id="sequenceFlow-fd92628a-419a-4e4e-aeaa-19aa1a63e6e2" name="验证不通过"
                      sourceRef="gateway_validation_result" targetRef="task_modify_record">
            <conditionExpression xsi:type="tFormalExpression">
                <![CDATA[ ${validationResult == 'failed'} ]]>
            </conditionExpression>
        </sequenceFlow>

    </process>
    <bpmndi:BPMNDiagram id="BPMNDiagram_submission_tech_assistant_opinion_record_process">
        <bpmndi:BPMNPlane bpmnElement="submission_tech_assistant_opinion_record_process" id="BPMNPlane_submission_tech_assistant_opinion_record_process">
            <bpmndi:BPMNShape bpmnElement="startEvent" id="BPMNShape_startEvent">
                <omgdc:Bounds height="30.0" width="30.0" x="0.0" y="104.0"/>
            </bpmndi:BPMNShape>
            <bpmndi:BPMNShape bpmnElement="task_submit" id="BPMNShape_task_submit">
                <omgdc:Bounds height="60.0" width="100.0" x="60.0" y="89.0"/>
            </bpmndi:BPMNShape>
            <bpmndi:BPMNShape bpmnElement="gateway_is_v_process" id="BPMNShape_gateway_is_v_process">
                <omgdc:Bounds height="40.0" width="40.0" x="210.0" y="99.0"/>
            </bpmndi:BPMNShape>
            <bpmndi:BPMNShape bpmnElement="task_internal_judge" id="BPMNShape_task_internal_judge">
                <omgdc:Bounds height="60.0" width="100.0" x="320.0" y="15.0"/>
            </bpmndi:BPMNShape>
            <bpmndi:BPMNShape bpmnElement="gateway_is_skipped" id="BPMNShape_gateway_is_skipped">
                <omgdc:Bounds height="40.0" width="40.0" x="470.0" y="25.0"/>
            </bpmndi:BPMNShape>
            <bpmndi:BPMNShape bpmnElement="task_select_reviewer" id="BPMNShape_task_select_reviewer">
                <omgdc:Bounds height="60.0" width="100.0" x="440.0" y="155.0"/>
            </bpmndi:BPMNShape>
            <bpmndi:BPMNShape bpmnElement="task_review_opinion" id="BPMNShape_task_review_opinion">
                <omgdc:Bounds height="60.0" width="100.0" x="600.0" y="155.0"/>
            </bpmndi:BPMNShape>
            <bpmndi:BPMNShape bpmnElement="task_select_modifier" id="BPMNShape_task_select_modifier">
                <omgdc:Bounds height="60.0" width="100.0" x="750.0" y="155.0"/>
            </bpmndi:BPMNShape>
            <bpmndi:BPMNShape bpmnElement="task_modify_record" id="BPMNShape_task_modify_record">
                <omgdc:Bounds height="60.0" width="100.0" x="930.0" y="155.0"/>
            </bpmndi:BPMNShape>
            <bpmndi:BPMNShape bpmnElement="task_validate_modification" id="BPMNShape_task_validate_modification">
                <omgdc:Bounds height="60.0" width="100.0" x="1110.0" y="155.0"/>
            </bpmndi:BPMNShape>
            <bpmndi:BPMNShape bpmnElement="gateway_validation_result" id="BPMNShape_gateway_validation_result">
                <omgdc:Bounds height="40.0" width="40.0" x="1245.0" y="99.0"/>
            </bpmndi:BPMNShape>
            <bpmndi:BPMNShape bpmnElement="endEvent_completed" id="BPMNShape_endEvent_completed">
                <omgdc:Bounds height="28.0" width="28.0" x="1400.0" y="105.0"/>
            </bpmndi:BPMNShape>
            <bpmndi:BPMNEdge bpmnElement="sequenceFlow-33163e23-3b3d-436b-bb26-e3049b48c721"
                             id="BPMNEdge_sequenceFlow-33163e23-3b3d-436b-bb26-e3049b48c721"
                             flowable:sourceDockerX="20.0" flowable:sourceDockerY="20.0" flowable:targetDockerX="14.0"
                             flowable:targetDockerY="14.0">
                <omgdi:waypoint x="509.9489205713006" y="45.0"/>
                <omgdi:waypoint x="1414.0" y="45.0"/>
                <omgdi:waypoint x="1414.0" y="105.0"/>
            </bpmndi:BPMNEdge>
            <bpmndi:BPMNEdge bpmnElement="sequenceFlow-23016e96-80d0-4a6f-8ac7-9b9776c2f7e2"
                             id="BPMNEdge_sequenceFlow-23016e96-80d0-4a6f-8ac7-9b9776c2f7e2"
                             flowable:sourceDockerX="50.0" flowable:sourceDockerY="30.0" flowable:targetDockerX="20.0"
                             flowable:targetDockerY="20.0">
                <omgdi:waypoint x="1209.95" y="185.0"/>
                <omgdi:waypoint x="1265.0" y="185.0"/>
                <omgdi:waypoint x="1265.0" y="138.91506069802736"/>
            </bpmndi:BPMNEdge>
            <bpmndi:BPMNEdge bpmnElement="sequenceFlow-98e8f10a-da79-4ddd-8e1a-54e46ed26d3d"
                             id="BPMNEdge_sequenceFlow-98e8f10a-da79-4ddd-8e1a-54e46ed26d3d"
                             flowable:sourceDockerX="50.0" flowable:sourceDockerY="30.0" flowable:targetDockerX="50.0"
                             flowable:targetDockerY="30.0">
                <omgdi:waypoint x="539.95" y="185.0"/>
                <omgdi:waypoint x="600.0" y="185.0"/>
            </bpmndi:BPMNEdge>
            <bpmndi:BPMNEdge bpmnElement="sequenceFlow-341c6414-dd83-4d3c-a291-e31ec1616fe1"
                             id="BPMNEdge_sequenceFlow-341c6414-dd83-4d3c-a291-e31ec1616fe1"
                             flowable:sourceDockerX="50.0" flowable:sourceDockerY="30.0" flowable:targetDockerX="50.0"
                             flowable:targetDockerY="30.0">
                <omgdi:waypoint x="849.9499999999999" y="185.0"/>
                <omgdi:waypoint x="929.9999999998699" y="185.0"/>
            </bpmndi:BPMNEdge>
            <bpmndi:BPMNEdge bpmnElement="sequenceFlow-06f27e05-5cb5-4cac-bc7e-144e50fc4a31"
                             id="BPMNEdge_sequenceFlow-06f27e05-5cb5-4cac-bc7e-144e50fc4a31"
                             flowable:sourceDockerX="50.0" flowable:sourceDockerY="30.0" flowable:targetDockerX="20.0"
                             flowable:targetDockerY="20.0">
                <omgdi:waypoint x="159.9499999999898" y="119.0"/>
                <omgdi:waypoint x="210.0" y="119.0"/>
            </bpmndi:BPMNEdge>
            <bpmndi:BPMNEdge bpmnElement="sequenceFlow-93ecc5c9-4e60-4077-9ddd-d9f341c52e2b"
                             id="BPMNEdge_sequenceFlow-93ecc5c9-4e60-4077-9ddd-d9f341c52e2b"
                             flowable:sourceDockerX="50.0" flowable:sourceDockerY="30.0" flowable:targetDockerX="20.0"
                             flowable:targetDockerY="20.0">
                <omgdi:waypoint x="419.95000000000005" y="45.0"/>
                <omgdi:waypoint x="470.0" y="45.0"/>
            </bpmndi:BPMNEdge>
            <bpmndi:BPMNEdge bpmnElement="sequenceFlow-28a4933d-521e-4cc9-8d33-dbb26ee86684"
                             id="BPMNEdge_sequenceFlow-28a4933d-521e-4cc9-8d33-dbb26ee86684"
                             flowable:sourceDockerX="50.0" flowable:sourceDockerY="30.0" flowable:targetDockerX="50.0"
                             flowable:targetDockerY="30.0">
                <omgdi:waypoint x="699.9499999999999" y="185.0"/>
                <omgdi:waypoint x="750.0" y="185.0"/>
            </bpmndi:BPMNEdge>
            <bpmndi:BPMNEdge bpmnElement="sequenceFlow-fd92628a-419a-4e4e-aeaa-19aa1a63e6e2"
                             id="BPMNEdge_sequenceFlow-fd92628a-419a-4e4e-aeaa-19aa1a63e6e2"
                             flowable:sourceDockerX="20.0" flowable:sourceDockerY="20.0" flowable:targetDockerX="50.0"
                             flowable:targetDockerY="30.0">
                <omgdi:waypoint x="1245.0" y="119.0"/>
                <omgdi:waypoint x="980.0" y="119.0"/>
                <omgdi:waypoint x="980.0" y="155.0"/>
            </bpmndi:BPMNEdge>
            <bpmndi:BPMNEdge bpmnElement="sequenceFlow-eeb1d2df-4bd3-43b7-b386-a14efc9369e8"
                             id="BPMNEdge_sequenceFlow-eeb1d2df-4bd3-43b7-b386-a14efc9369e8"
                             flowable:sourceDockerX="20.0" flowable:sourceDockerY="20.0" flowable:targetDockerX="50.0"
                             flowable:targetDockerY="30.0">
                <omgdi:waypoint x="230.0" y="99.0"/>
                <omgdi:waypoint x="230.0" y="45.0"/>
                <omgdi:waypoint x="320.0" y="45.0"/>
            </bpmndi:BPMNEdge>
            <bpmndi:BPMNEdge bpmnElement="sequenceFlow-8817e519-85d3-44fb-87fb-815eeaf15a31"
                             id="BPMNEdge_sequenceFlow-8817e519-85d3-44fb-87fb-815eeaf15a31"
                             flowable:sourceDockerX="20.0" flowable:sourceDockerY="20.0" flowable:targetDockerX="14.0"
                             flowable:targetDockerY="14.0">
                <omgdi:waypoint x="1284.9433098591433" y="119.0"/>
                <omgdi:waypoint x="1400.0" y="119.0"/>
            </bpmndi:BPMNEdge>
            <bpmndi:BPMNEdge bpmnElement="sequenceFlow-ce91565e-35fa-4bf7-9361-3cfbaf9fe6df"
                             id="BPMNEdge_sequenceFlow-ce91565e-35fa-4bf7-9361-3cfbaf9fe6df"
                             flowable:sourceDockerX="20.0" flowable:sourceDockerY="20.0" flowable:targetDockerX="50.0"
                             flowable:targetDockerY="30.0">
                <omgdi:waypoint x="230.0" y="138.93490922844174"/>
                <omgdi:waypoint x="230.0" y="185.0"/>
                <omgdi:waypoint x="439.999999999883" y="185.0"/>
            </bpmndi:BPMNEdge>
            <bpmndi:BPMNEdge bpmnElement="sequenceFlow-fa7eda4d-85ad-4633-b90a-c8e293b49b73"
                             id="BPMNEdge_sequenceFlow-fa7eda4d-85ad-4633-b90a-c8e293b49b73"
                             flowable:sourceDockerX="15.0" flowable:sourceDockerY="15.0" flowable:targetDockerX="50.0"
                             flowable:targetDockerY="30.0">
                <omgdi:waypoint x="29.949997975751963" y="119.0"/>
                <omgdi:waypoint x="59.99999999995154" y="119.0"/>
            </bpmndi:BPMNEdge>
            <bpmndi:BPMNEdge bpmnElement="sequenceFlow-ccb26438-df06-4ecb-ba16-66738f42435b"
                             id="BPMNEdge_sequenceFlow-ccb26438-df06-4ecb-ba16-66738f42435b"
                             flowable:sourceDockerX="20.0" flowable:sourceDockerY="20.0" flowable:targetDockerX="50.0"
                             flowable:targetDockerY="30.0">
                <omgdi:waypoint x="490.0" y="64.9428800856531"/>
                <omgdi:waypoint x="490.0" y="155.0"/>
            </bpmndi:BPMNEdge>
            <bpmndi:BPMNEdge bpmnElement="sequenceFlow-a938f8e3-f266-4006-9f77-114815fecdfd"
                             id="BPMNEdge_sequenceFlow-a938f8e3-f266-4006-9f77-114815fecdfd"
                             flowable:sourceDockerX="50.0" flowable:sourceDockerY="30.0" flowable:targetDockerX="50.0"
                             flowable:targetDockerY="30.0">
                <omgdi:waypoint x="1029.95" y="185.0"/>
                <omgdi:waypoint x="1109.99999999987" y="185.0"/>
            </bpmndi:BPMNEdge>
        </bpmndi:BPMNPlane>
    </bpmndi:BPMNDiagram>
</definitions>